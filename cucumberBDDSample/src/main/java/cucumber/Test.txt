import com.mongodb.ConnectionString;
import com.mongodb.MongoClientSettings;
import com.mongodb.client.MongoClients;
import com.mongodb.client.MongoClient;
import com.mongodb.client.MongoDatabase;
import com.mongodb.client.MongoCollection;
import org.bson.Document;
import com.mongodb.client.model.Filters;

public class MongoDBConnection {
    public static void main(String[] args) {
        // Connection string
        String uri = "mongodb://username:password@host:port/database?authMechanism=PLAIN&authSource=%24external&tls=true&tlsCAFile=/path/to/ca-certificate.crt";

        // Create MongoClientSettings
        ConnectionString connectionString = new ConnectionString(uri);
        MongoClientSettings settings = MongoClientSettings.builder()
                .applyConnectionString(connectionString)
                .build();

        // Create MongoClient
        MongoClient mongoClient = MongoClients.create(settings);

        // Get the database
        MongoDatabase database = mongoClient.getDatabase("yourDatabaseName");

        // Get the collection
        MongoCollection<Document> collection = database.getCollection("yourCollectionName");

        // Execute a basic query: Find a document with a specific field value
        Document query = new Document("fieldName", "fieldValue");
        Document result = collection.find(query).first();

        // Print the result
        if (result != null) {
            System.out.println("Found document: " + result.toJson());
        } else {
            System.out.println("No document found with the specified field value.");
        }

        // Close the client
        mongoClient.close();
    }
}
